import{a as m,j as r}from"./emotion-react-jsx-runtime.browser.esm-CDSRZb9c.js";import{r as i}from"./chunk-EPOLDU6W-B8pbzjzn.js";import{n as S,F as l}from"./FlexWrapper-B3ayG6XS.js";import{u as W,t as k}from"./index-CjmaIs_R.js";import{B as j}from"./media-D8HfPojw.js";import{T as C,G as P}from"./TextInputArea-Cqpc5ClC.js";import{u as R,k as L,q as U}from"./useIsDevice-B4XmIr43.js";import{T as v}from"./Typography-BI6YlVsB.js";import{p as A}from"./ReviewBlock-FBf6qgCF.js";import{u as M}from"./useUserStore-BXC7wunu.js";import{u as O}from"./useTranslation-DcygOF4d.js";const z=S(l)`
    padding: 8px 10px;
    width: 100%;
    border-radius: 6px;
    border: 1px ${({theme:s})=>s.colors.Background.Block.dark} solid;
    background-color: ${({theme:s})=>s.colors.Background.Block.default};
`,D=S(l)`
    height: 160px;
`,H=S(l)`
    flex-wrap: wrap;
`;function se({name:s,lectureId:a,professors:Q,year:B,semester:E}){const{t:n}=O(),{user:q,status:K}=M(),t=W(),[e,T]=i.useState(null),{requestFunction:N}=R("POST","/reviews",{onSuccess:()=>{t.invalidateQueries({queryKey:["/reviews"]}),t.invalidateQueries({queryKey:[`/users/${q?.id}/lectures`]}),t.invalidateQueries({queryKey:["/users/written-reviews"]}),t.invalidateQueries({queryKey:["/users/writable-review"]})}}),{requestFunction:G}=R("PUT",`/reviews/${e?.id}`,{onSuccess:()=>{t.invalidateQueries({queryKey:["/reviews"]}),t.invalidateQueries({queryKey:[`/users/${q?.id}/lectures`]}),t.invalidateQueries({queryKey:["/users/written-reviews"]}),t.invalidateQueries({queryKey:["/users/writable-review"]})}}),{query:f}=R("GET","/users/written-reviews",{enabled:K==="success"});i.useEffect(()=>{if(f.data){const o=f.data.reviews.find(p=>p.lectureId===a);T(o||null)}},[f.data,a]);const[w,y]=i.useState(""),[c,h]=i.useState(0),[u,g]=i.useState(0),[d,x]=i.useState(0);function b(){y(""),h(0),g(0),x(0)}i.useEffect(()=>{b()},[a]),i.useEffect(()=>{e?(y(e.content),h(e.grade),g(e.load),x(e.speech)):b()},[e]);function $(){e?(G({content:w,grade:c,load:u,speech:d}),k("Edit Review",{reviewId:e.id,lectureId:a,courseName:s,grade:c,load:u,speech:d})):(N({lectureId:a,content:w,grade:c,load:u,speech:d}),k("Submit Review",{lectureId:a,courseName:s,grade:c,load:u,speech:d}))}return m(z,{direction:"column",gap:8,align:"stretch",children:[m(l,{direction:"row",gap:6,align:"center",children:[r(v,{type:"NormalBold",color:"Text.default",children:s}),[A(Q),B,L(E||U.SPRING)].map((o,p)=>r(v,{type:"Normal",color:"Text.lighter",children:o},p))]}),r(D,{direction:"column",gap:0,justify:"stretch",align:"stretch",children:r(C,{placeholder:n("common.review.writingPlaceholder"),value:w,handleChange:y,area:!0})}),m(l,{direction:"row",gap:20,justify:"space-between",align:"center",children:[r(H,{direction:"row",gap:12,children:[[n("common.grade"),c,h],[n("common.load"),u,g],[n("common.speech"),d,x]].map(([o,p,F])=>m(l,{direction:"row",gap:6,align:"center",children:[r(v,{type:"Normal",color:"Text.default",children:o}),r(P,{score:p,setScore:F})]},o))}),r(j,{type:w&&c&&d&&u?"selected":"disabled",$paddingLeft:8,$paddingTop:8,onClick:$,children:r(v,{type:"Normal",children:n(e?"writeReviews.write.edit":"common.upload")})})]})]})}export{se as R};
//# sourceMappingURL=ReviewWritingBlock-Dxr-x0I2.js.map
