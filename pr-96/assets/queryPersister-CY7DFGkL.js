function o(e){return new Promise((n,t)=>{e.oncomplete=e.onsuccess=()=>n(e.result),e.onabort=e.onerror=()=>t(e.error)})}function d(e,n){let t;const i=()=>{if(t)return t;const r=indexedDB.open(e);return r.onupgradeneeded=()=>r.result.createObjectStore(n),t=o(r),t.then(c=>{c.onclose=()=>t=void 0},()=>{}),t};return(r,c)=>i().then(l=>c(l.transaction(n,r).objectStore(n)))}let a;function s(){return a||(a=d("keyval-store","keyval")),a}function f(e,n=s()){return n("readonly",t=>o(t.get(e)))}function y(e,n,t=s()){return t("readwrite",i=>(i.put(n,e),o(i.transaction)))}function p(e,n=s()){return n("readwrite",t=>(t.delete(e),o(t.transaction)))}const u="otlplus-query-cache";function w(e){return JSON.stringify(e)}function S(e){return JSON.parse(e)}function b(){return{persistClient:async e=>{const n=w(e);await y(u,n)},restoreClient:async()=>{const e=await f(u);if(e)return S(e)},removeClient:async()=>{await p(u)}}}const g=b();async function h(){await g.removeClient()}export{h as c,g as i};
//# sourceMappingURL=queryPersister-CY7DFGkL.js.map
