import{a as w,j as i}from"./emotion-react-jsx-runtime.browser.esm-t85JDVx0.js";import{r as o}from"./chunk-EPOLDU6W-CBZtkPXU.js";import{n as S,F as l}from"./FlexWrapper-enwfxs-C.js";import{u as W,t as E}from"./index-DDtFtywk.js";import{B as j}from"./media-oHICF8O9.js";import{T as C,G as I}from"./TextInputArea-XMA3_Yul.js";import{u as R,k as P,q as _}from"./useIsDevice-N0ab4jsW.js";import{T as m}from"./Typography-DF6u0bvu.js";import{p as D}from"./ReviewBlock-7BxgTSKA.js";import{u as L}from"./useUserStore-Cw33KvLq.js";import{u as A}from"./useTranslation-DsZ4rQn1.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};e.SENTRY_RELEASE={id:"49f485c9d7c342c7f1c8a17d8538fd3d0fe30d46"}}catch{}})();try{(function(){var e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},r=new e.Error().stack;r&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[r]="82c233c7-9a88-4bd3-b599-ca886d5383c0",e._sentryDebugIdIdentifier="sentry-dbid-82c233c7-9a88-4bd3-b599-ca886d5383c0")})()}catch{}const U=S(l)`
    padding: 8px 10px;
    width: 100%;
    border-radius: 6px;
    border: 1px ${({theme:e})=>e.colors.Background.Block.dark} solid;
    background-color: ${({theme:e})=>e.colors.Background.Block.default};
`,M=S(l)`
    height: 160px;
`,O=S(l)`
    flex-wrap: wrap;
`;function se({name:e,lectureId:r,professors:k,year:Q,semester:B}){const{t:a}=A(),{user:T,status:N}=L(),s=W(),[t,x]=o.useState(null),{requestFunction:K}=R("POST","/reviews",{onSuccess:()=>{s.invalidateQueries({queryKey:["/reviews"]}),s.invalidateQueries({queryKey:[`/users/${T?.id}/lectures`]}),s.invalidateQueries({queryKey:["/users/written-reviews"]}),s.invalidateQueries({queryKey:["/users/writable-review"]})}}),{requestFunction:G}=R("PUT",`/reviews/${t?.id}`,{onSuccess:()=>{s.invalidateQueries({queryKey:["/reviews"]}),s.invalidateQueries({queryKey:[`/users/${T?.id}/lectures`]}),s.invalidateQueries({queryKey:["/users/written-reviews"]}),s.invalidateQueries({queryKey:["/users/writable-review"]})}}),{query:y}=R("GET","/users/written-reviews",{enabled:N==="success"});o.useEffect(()=>{if(y.data){const n=y.data.reviews.find(p=>p.lectureId===r);x(n||null)}},[y.data,r]);const[f,v]=o.useState(""),[d,g]=o.useState(0),[c,h]=o.useState(0),[u,b]=o.useState(0);function q(){v(""),g(0),h(0),b(0)}o.useEffect(()=>{q()},[r]),o.useEffect(()=>{t?(v(t.content),g(t.grade),h(t.load),b(t.speech)):q()},[t]);function $(){t?(G({content:f,grade:d,load:c,speech:u}),E("Edit Review",{reviewId:t.id,lectureId:r,courseName:e,grade:d,load:c,speech:u})):(K({lectureId:r,content:f,grade:d,load:c,speech:u}),E("Submit Review",{lectureId:r,courseName:e,grade:d,load:c,speech:u}))}return w(U,{direction:"column",gap:8,align:"stretch",children:[w(l,{direction:"row",gap:6,align:"center",children:[i(m,{type:"NormalBold",color:"Text.default",children:e}),[D(k),Q,P(B||_.SPRING)].map((n,p)=>i(m,{type:"Normal",color:"Text.lighter",children:n},p))]}),i(M,{direction:"column",gap:0,justify:"stretch",align:"stretch",children:i(C,{placeholder:a("common.review.writingPlaceholder"),value:f,handleChange:v,area:!0})}),w(l,{direction:"row",gap:20,justify:"space-between",align:"center",children:[i(O,{direction:"row",gap:12,children:[[a("common.grade"),d,g],[a("common.load"),c,h],[a("common.speech"),u,b]].map(([n,p,F])=>w(l,{direction:"row",gap:6,align:"center",children:[i(m,{type:"Normal",color:"Text.default",children:n}),i(I,{score:p,setScore:F})]},n))}),i(j,{type:f&&d&&u&&c?"selected":"disabled",$paddingLeft:8,$paddingTop:8,onClick:$,children:i(m,{type:"Normal",children:a(t?"writeReviews.write.edit":"common.upload")})})]})]})}export{se as R};
//# sourceMappingURL=ReviewWritingBlock-5a0PeY9l.js.map
