import{a as w,j as r}from"./emotion-react-jsx-runtime.browser.esm-D2PZwVTC.js";import{r as i}from"./chunk-UIGDSWPH-ClhI_Z4l.js";import{n as R,F as a}from"./FlexWrapper-B6Hxm4Zw.js";import{u as N}from"./index-ZBsVm-Fx.js";import{B as W}from"./media-MLnbxw48.js";import{T as j,G as C}from"./TextInputArea-CnDje9kG.js";import{u as S,k as P,q as L}from"./useIsDevice-DO0EICOs.js";import{T as v}from"./Typography-DeI78L6T.js";import{p as U}from"./ReviewBlock-DmnEfFvO.js";import{u as A}from"./useUserStore-B4JDZcv5.js";import{u as I}from"./useTranslation-DrmvPmDd.js";const M=R(a)`
    padding: 8px 10px;
    width: 100%;
    border-radius: 6px;
    border: 1px ${({theme:n})=>n.colors.Background.Block.dark} solid;
    background-color: ${({theme:n})=>n.colors.Background.Block.default};
`,O=R(a)`
    height: 160px;
`,z=R(a)`
    flex-wrap: wrap;
`;function ie({name:n,lectureId:u,professors:b,year:k,semester:B}){const{t:o}=I(),{user:q,status:K}=A(),t=N(),[e,T]=i.useState(null),{requestFunction:E}=S("POST","/reviews",{onSuccess:()=>{t.invalidateQueries({queryKey:["/reviews"]}),t.invalidateQueries({queryKey:[`/users/${q?.id}/lectures`]}),t.invalidateQueries({queryKey:["/users/written-reviews"]}),t.invalidateQueries({queryKey:["/users/writable-review"]})}}),{requestFunction:G}=S("PUT",`/reviews/${e?.id}`,{onSuccess:()=>{t.invalidateQueries({queryKey:["/reviews"]}),t.invalidateQueries({queryKey:[`/users/${q?.id}/lectures`]}),t.invalidateQueries({queryKey:["/users/written-reviews"]}),t.invalidateQueries({queryKey:["/users/writable-review"]})}}),{query:f}=S("GET","/users/written-reviews",{enabled:K==="success"});i.useEffect(()=>{if(f.data){const s=f.data.reviews.find(c=>c.lectureId===u);T(s||null)}},[f.data,u]);const[l,y]=i.useState(""),[d,h]=i.useState(0),[p,g]=i.useState(0),[m,x]=i.useState(0);function Q(){y(""),h(0),g(0),x(0)}i.useEffect(()=>{Q()},[u]),i.useEffect(()=>{e?(y(e.content),h(e.grade),g(e.load),x(e.speech)):Q()},[e]);function $(){e?G({content:l,grade:d,load:p,speech:m}):E({lectureId:u,content:l,grade:d,load:p,speech:m})}return w(M,{direction:"column",gap:8,align:"stretch",children:[w(a,{direction:"row",gap:6,align:"center",children:[r(v,{type:"NormalBold",color:"Text.default",children:n}),[U(b),k,P(B||L.SPRING)].map((s,c)=>r(v,{type:"Normal",color:"Text.lighter",children:s},c))]}),r(O,{direction:"column",gap:0,justify:"stretch",align:"stretch",children:r(j,{placeholder:o("common.review.writingPlaceholder"),value:l,handleChange:y,area:!0})}),w(a,{direction:"row",gap:20,justify:"space-between",align:"center",children:[r(z,{direction:"row",gap:12,children:[[o("common.grade"),d,h],[o("common.load"),p,g],[o("common.speech"),m,x]].map(([s,c,F])=>w(a,{direction:"row",gap:6,align:"center",children:[r(v,{type:"Normal",color:"Text.default",children:s}),r(C,{score:c,setScore:F})]},s))}),r(W,{type:l&&d&&m&&p?"selected":"disabled",$paddingLeft:8,$paddingTop:8,onClick:$,children:r(v,{type:"Normal",children:o(e?"writeReviews.write.edit":"common.upload")})})]})]})}export{ie as R};
//# sourceMappingURL=ReviewWritingBlock-vWjRFdBA.js.map
