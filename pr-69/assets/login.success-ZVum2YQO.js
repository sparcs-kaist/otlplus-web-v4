import{w as y,y as h,r as l}from"./chunk-UIGDSWPH-ClhI_Z4l.js";import{u as p,d as m,b as d}from"./index-BDs7kvTb.js";import{c as w}from"./queryPersister-Dnan5egx.js";import{u as v}from"./useTranslation-DrmvPmDd.js";import"./env-DSyOjV07.js";const C=y(function(){const a=h(),s=p(),{i18n:c}=v(),r=l.useRef(!0);return l.useEffect(()=>(r.current=!0,(async()=>{const f=window.location.hash.substring(1),i=new URLSearchParams(f),n=i.get("accessToken"),o=i.get("refreshToken"),u=c.resolvedLanguage||"ko";if(n&&o){if(navigator.userAgent.includes("otl-app")){window.location.href=`org.sparcs.otl://login?accessToken=${n}&refreshToken=${o}`;return}localStorage.setItem("accessToken",n),localStorage.setItem("refreshToken",o),await w(),s.removeQueries({queryKey:["/users/info"]}),s.removeQueries({queryKey:["/timetables"]}),await s.prefetchQuery({queryKey:["/users/info",null,u],queryFn:async()=>{const{data:e}=await m.get("/api/v2/users/info");return e}});try{const{data:e}=await d.get("/api/v2/semesters");if(e?.semesters?.length>0){const t=e.semesters[e.semesters.length-1];t&&await s.prefetchQuery({queryKey:["/timetables/my-timetable",{year:t.year,semester:t.semester},u],queryFn:async()=>{const{data:g}=await m.get("/api/v2/timetables/my-timetable",{params:{year:t.year,semester:t.semester}});return g}})}}catch(e){console.error("Failed to prefetch timetable:",e)}r.current&&a("/",{replace:!0})}else r.current&&a("/",{replace:!0})})(),()=>{r.current=!1}),[a,s,c.resolvedLanguage]),null});export{C as default};
//# sourceMappingURL=login.success-ZVum2YQO.js.map
