{"version":3,"file":"index-Btik6DhA.js","sources":["../../../app/features/main/sections/ScheduleSection/index.tsx"],"sourcesContent":["import { useEffect, useState } from \"react\"\n\nimport styled from \"@emotion/styled\"\nimport { Trans, useTranslation } from \"react-i18next\"\nimport { Link } from \"react-router-dom\"\n\nimport { type SemesterEnum, semesterToString } from \"@/common/enum/semesterEnum\"\nimport FlexWrapper from \"@/common/primitives/FlexWrapper\"\nimport Typography from \"@/common/primitives/Typography\"\nimport { useAPI } from \"@/utils/api/useAPI\"\n\nimport Widget from \"../../../../common/primitives/Widget\"\n\nconst StyledLink = styled(Link)`\n    color: ${({ theme }) => theme.colors.Highlight.default};\n    text-decoration: none;\n    font-size: ${({ theme }) => theme.fonts.NormalBold.fontSize}px;\n    font-weight: ${({ theme }) => theme.fonts.NormalBold.fontWeight};\n\n    &:hover {\n        color: ${({ theme }) => theme.colors.Highlight.dark};\n    }\n`\n\nfunction ScheduleSection() {\n    const { query } = useAPI(\"GET\", \"/semesters\")\n\n    const [now, setNow] = useState(new Date())\n    const [timeLeft, setTimeLeft] = useState<string>(\"\")\n\n    const [yearSemester, setYearSemester] = useState<{\n        year: number\n        semester: SemesterEnum\n    } | null>(null)\n    const [contentKey, setContentKey] = useState<string>(\"\")\n    const [dueDate, setDueDate] = useState<Date | null>(null)\n\n    const { t } = useTranslation()\n\n    useEffect(() => {\n        const timer = setInterval(() => setNow(new Date()), 1000)\n        return () => clearInterval(timer)\n    }, [])\n\n    useEffect(() => {\n        if (!query.data?.semesters) return\n        const currentSemester = query.data.semesters[query.data.semesters.length - 1]\n        if (!currentSemester) return\n\n        setYearSemester({\n            year: currentSemester.year,\n            semester: currentSemester.semester,\n        })\n\n        const scheduleItems = (\n            Object.entries(currentSemester).filter(\n                ([key, value]) => key !== \"year\" && key !== \"semester\" && value !== null,\n            ) as [string, string][]\n        )\n            .map(([key, value]) => [key, new Date(value)] as [string, Date])\n            .sort((a, b) => a[1].getTime() - b[1].getTime())\n\n        for (const [key, date] of scheduleItems) {\n            if (now.getTime() <= date.getTime()) {\n                setContentKey(key)\n                setDueDate(date)\n                return\n            }\n        }\n\n        // If all dates have passed, show the last one\n        const lastItem = scheduleItems[scheduleItems.length - 1]\n        if (!lastItem) return\n        setContentKey(lastItem[0])\n        setDueDate(lastItem[1])\n    }, [query.data])\n\n    useEffect(() => {\n        if (!dueDate) return\n        const diff = dueDate.getTime() - now.getTime()\n        const isPast = diff < 0\n        const absDiff = Math.abs(diff)\n        const days = Math.floor(absDiff / (1000 * 60 * 60 * 24))\n        const hours = Math.floor((absDiff / (1000 * 60 * 60)) % 24)\n        const minutes = Math.floor((absDiff / (1000 * 60)) % 60)\n        const seconds = Math.floor((absDiff / 1000) % 60)\n        setTimeLeft(\n            `D${isPast ? \"+\" : \"-\"}${days} ${hours}${t(\"common.hours\")} ${minutes}${t(\"common.minutes\")} ${seconds}${t(\"common.seconds\")}`,\n        )\n    }, [now, dueDate])\n\n    function getContentString() {\n        if (!yearSemester) return t(`main.schedule.contents.${contentKey}`)\n        return (\n            yearSemester.year.toString() +\n            \" \" +\n            semesterToString(yearSemester.semester) +\n            \" \" +\n            t(`main.schedule.contents.${contentKey}`)\n        )\n    }\n\n    if (!dueDate) return null\n\n    return (\n        <Widget direction=\"column\" align=\"stretch\" gap={0} padding=\"23px 30px\">\n            <FlexWrapper direction=\"column\" align=\"stretch\" gap={16}>\n                <FlexWrapper direction=\"column\" align=\"center\" gap={10}>\n                    <FlexWrapper direction=\"column\" align=\"stretch\" gap={0}>\n                        <FlexWrapper\n                            direction=\"row\"\n                            justify=\"center\"\n                            gap={0}\n                            style={{ textAlign: \"center\" }}\n                        >\n                            <Typography type=\"BiggerBold\" color=\"Text.dark\">\n                                <Trans\n                                    i18nKey=\"main.schedule.title\"\n                                    values={{ content: getContentString() }}\n                                />\n                            </Typography>\n                        </FlexWrapper>\n                        <FlexWrapper\n                            direction=\"row\"\n                            justify=\"center\"\n                            gap={0}\n                            style={{ textAlign: \"center\" }}\n                        >\n                            <Typography type=\"BiggerBold\" color=\"Text.dark\">\n                                {timeLeft}\n                            </Typography>\n                        </FlexWrapper>\n                    </FlexWrapper>\n                    <FlexWrapper\n                        direction=\"column\"\n                        gap={0}\n                        style={{ textAlign: \"center\" }}\n                    >\n                        <Typography type=\"Normal\" color=\"Text.placeholder\">\n                            {getContentString()} {dueDate.getFullYear()}.\n                            {String(dueDate.getMonth() + 1).padStart(2, \"0\")}.\n                            {String(dueDate.getDate()).padStart(2, \"0\")}\n                        </Typography>\n                    </FlexWrapper>\n                </FlexWrapper>\n                <FlexWrapper direction=\"column\" align=\"flex-end\" gap={0}>\n                    <StyledLink to=\"https://erp.kaist.ac.kr\" target=\"_blank\">\n                        {t(\"main.schedule.link\")}\n                    </StyledLink>\n                </FlexWrapper>\n            </FlexWrapper>\n        </Widget>\n    )\n}\n\nexport default ScheduleSection\n"],"names":["StyledLink","styled","Link","theme","ScheduleSection","query","useAPI","now","setNow","useState","timeLeft","setTimeLeft","yearSemester","setYearSemester","contentKey","setContentKey","dueDate","setDueDate","t","useTranslation","useEffect","timer","currentSemester","scheduleItems","key","value","a","b","date","lastItem","diff","isPast","absDiff","days","hours","minutes","seconds","getContentString","semesterToString","Widget","FlexWrapper","jsxs","jsx","Typography","Trans"],"mappings":"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"}