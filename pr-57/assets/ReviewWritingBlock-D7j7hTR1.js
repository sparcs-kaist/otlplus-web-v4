import{a as w,j as r}from"./emotion-react-jsx-runtime.browser.esm-Cql-SmI8.js";import{r as t}from"./chunk-UIGDSWPH-ClC-Bows.js";import{n as R,F as a}from"./FlexWrapper-B3Tmr1Ow.js";import{u as N,b as W}from"./index-DasAm1UD.js";import{u as S,q as j,v as C,B as P}from"./useIsDevice-DnuNoJZ_.js";import{T as L,G as U}from"./TextInputArea-CSuzkfcU.js";import{T as v}from"./Typography-YMZw2QHy.js";import{p as A}from"./ReviewBlock-DEVNBjcP.js";import{u as I}from"./useUserStore-B-P0R9Aj.js";const M=R(a)`
    padding: 8px 10px;
    width: 100%;
    border-radius: 6px;
    border: 1px ${({theme:n})=>n.colors.Background.Block.dark} solid;
    background-color: ${({theme:n})=>n.colors.Background.Block.default};
`,O=R(a)`
    height: 160px;
`,z=R(a)`
    flex-wrap: wrap;
`;function re({name:n,lectureId:u,professors:b,year:k,semester:Q}){const{t:i}=N(),{user:T,status:E}=I(),o=W(),[e,q]=t.useState(null),{requestFunction:G}=S("POST","/reviews",{onSuccess:()=>{o.invalidateQueries({queryKey:["/reviews"]}),o.invalidateQueries({queryKey:[`/users/${T?.id}/lectures`]}),o.invalidateQueries({queryKey:["/users/written-reviews"]})}}),{requestFunction:$}=S("PUT",`/reviews/${e?.id}`,{onSuccess:()=>{o.invalidateQueries({queryKey:["/reviews"]}),o.invalidateQueries({queryKey:[`/users/${T?.id}/lectures`]}),o.invalidateQueries({queryKey:["/users/written-reviews"]})}}),{query:f}=S("GET","/users/written-reviews",{enabled:E==="success"});t.useEffect(()=>{if(f.data){const s=f.data.reviews.find(c=>c.lectureId===u);q(s||null)}},[f.data,u]);const[d,h]=t.useState(""),[l,g]=t.useState(0),[p,y]=t.useState(0),[m,x]=t.useState(0);function B(){h(""),g(0),y(0),x(0)}t.useEffect(()=>{B()},[u]),t.useEffect(()=>{e?(h(e.content),g(e.grade),y(e.load),x(e.speech)):B()},[e]);function F(){e?$({content:d,grade:l,load:p,speech:m}):G({lectureId:u,content:d,grade:l,load:p,speech:m})}return w(M,{direction:"column",gap:8,align:"stretch",children:[w(a,{direction:"row",gap:6,align:"center",children:[r(v,{type:"NormalBold",color:"Text.default",children:n}),[A(b),k,j(Q||C.SPRING)].map((s,c)=>r(v,{type:"Normal",color:"Text.lighter",children:s},c))]}),r(O,{direction:"column",gap:0,justify:"stretch",align:"stretch",children:r(L,{placeholder:i("common.review.writingPlaceholder"),value:d,handleChange:h,area:!0})}),w(a,{direction:"row",gap:20,justify:"space-between",align:"center",children:[r(z,{direction:"row",gap:12,children:[[i("common.grade"),l,g],[i("common.load"),p,y],[i("common.speech"),m,x]].map(([s,c,K])=>w(a,{direction:"row",gap:6,align:"center",children:[r(v,{type:"Normal",color:"Text.default",children:s}),r(U,{score:c,setScore:K})]},s))}),r(P,{type:d&&l&&m&&p?"selected":"disabled",$paddingLeft:8,$paddingTop:8,onClick:F,children:r(v,{type:"Normal",children:i(e?"writeReviews.write.edit":"common.upload")})})]})]})}export{re as R};
//# sourceMappingURL=ReviewWritingBlock-D7j7hTR1.js.map
