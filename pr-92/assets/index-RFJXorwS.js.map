{"version":3,"file":"index-RFJXorwS.js","sources":["../../../app/features/main/components/CustomTimeTableGrid.tsx","../../../app/features/main/sections/TimeTableSection/index.tsx"],"sourcesContent":["import React, { useCallback, useMemo, useRef, useState } from \"react\"\n\nimport styled from \"@emotion/styled\"\nimport { useTranslation } from \"react-i18next\"\n\nimport FlexWrapper from \"@/common/primitives/FlexWrapper\"\nimport type { Lecture } from \"@/common/schemas/lecture\"\nimport { checkAnyOver24 } from \"@/utils/timetable/checkAnyOver24\"\nimport renderGrid from \"@/utils/timetable/renderGrid\"\nimport renderLectureTile from \"@/utils/timetable/renderLectureTile\"\nimport renderTargetArea from \"@/utils/timetable/renderTargetArea\"\n\ninterface GridProps {\n    cellWidth?: number\n    lectureSummary: Lecture[]\n    hover: Lecture[] | null\n    setHover: React.Dispatch<React.SetStateAction<Lecture[] | null>>\n    selected: Lecture | null\n    setSelected: React.Dispatch<React.SetStateAction<Lecture | null>>\n}\n\nconst FULL_HEIGHT = 926.5\nconst ROWS = 32\n\nconst SectionWrapper = styled.div`\n    display: flex;\n    flex-direction: row;\n    gap: 5px;\n    align-items: center;\n    height: fit-content;\n`\n\nconst TimeWrapper = styled.div`\n    padding-top: 15px;\n    display: flex;\n    flex-grow: 1;\n    flex-direction: column;\n    height: 100%;\n    justify-content: space-evenly;\n    gap: calc(var(--cell-height) * 2 - 11px);\n    font-size: 8px;\n    line-height: 11px;\n    color: ${({ theme }) => theme.colors.Text.default};\n`\n\nconst DateWrapper = styled.div`\n    width: var(--cell-width);\n    align-items: center;\n    font-size: 12px;\n    line-height: 15px;\n    padding-bottom: 5px;\n    text-align: center;\n    color: ${({ theme }) => theme.colors.Text.default};\n`\n\nconst GridContainer = styled.div`\n    display: inline-block;\n    position: relative;\n    user-select: none;\n`\n\nconst CustomTimeTableGrid: React.FC<GridProps> = ({\n    cellWidth = 120,\n    lectureSummary,\n    hover,\n    setHover,\n    selected,\n    setSelected,\n}) => {\n    const { t } = useTranslation()\n\n    const colPadding = 5\n    const m = 5\n    const begin = 8\n    const gridRef = useRef<HTMLDivElement>(null)\n    const dateHeader = [\n        t(\"common.days.monday\"),\n        t(\"common.days.tuesday\"),\n        t(\"common.days.wednesday\"),\n        t(\"common.days.thursday\"),\n        t(\"common.days.friday\"),\n    ]\n    const isAnyOver24 = checkAnyOver24(lectureSummary)\n    const n = isAnyOver24 ? 38 : 32\n    const end = isAnyOver24 ? 27 : 24\n    const cellHeight = FULL_HEIGHT / ROWS\n\n    const cssVariables = useMemo(\n        () =>\n            ({\n                \"--cell-height\": `${cellHeight}px`,\n                \"--cell-width\": `${cellWidth}px`,\n                \"--col-padding\": `${colPadding}px`,\n            }) as React.CSSProperties,\n        [cellHeight, cellWidth, colPadding],\n    )\n\n    const [draggingArea] = useState<Map<number, boolean[]>>(\n        new Map(\n            Array.from({ length: m }, (_, rowIndex) => [rowIndex, Array(n).fill(null)]),\n        ),\n    )\n\n    const grid = useMemo(\n        () => renderGrid(n, m, cellWidth, cellHeight, colPadding, [], 10, 0),\n        [n, m, cellWidth, cellHeight, colPadding],\n    )\n\n    const lectureTiles = useMemo(\n        () =>\n            renderLectureTile(\n                lectureSummary,\n                cellWidth,\n                cellHeight,\n                colPadding,\n                selected,\n                setSelected,\n                hover,\n                setHover,\n                false,\n                undefined,\n                true,\n            ),\n        [\n            lectureSummary,\n            cellWidth,\n            cellHeight,\n            colPadding,\n            selected,\n            setSelected,\n            hover,\n            setHover,\n        ],\n    )\n\n    const handleClick = useCallback(() => {\n        setSelected(null)\n    }, [setSelected])\n\n    return (\n        <SectionWrapper style={cssVariables}>\n            <TimeWrapper>\n                {Array.from({ length: end - begin + 1 }, (_, index) => index + begin).map(\n                    (number) => (\n                        <div key={number}>{number % 12 || 12}</div>\n                    ),\n                )}\n            </TimeWrapper>\n            <FlexWrapper direction=\"column\" gap={0}>\n                <FlexWrapper direction=\"row\" gap={5}>\n                    {dateHeader.map(\n                        (date, index) =>\n                            date !== \"none\" && (\n                                <DateWrapper\n                                    key={index}\n                                    style={date === \"\" ? { width: \"10px\" } : undefined}\n                                >\n                                    {date}\n                                </DateWrapper>\n                            ),\n                    )}\n                </FlexWrapper>\n                <GridContainer ref={gridRef} onClick={handleClick}>\n                    {grid}\n                    {renderTargetArea(\n                        true,\n                        draggingArea,\n                        \"rgba(229, 76, 101, 0.5)\",\n                        cellHeight,\n                        cellWidth,\n                        2,\n                        colPadding,\n                        [],\n                        0,\n                        0,\n                    )}\n                    {lectureTiles}\n                </GridContainer>\n            </FlexWrapper>\n        </SectionWrapper>\n    )\n}\n\nexport default React.memo(CustomTimeTableGrid)\n","import { useEffect, useRef, useState } from \"react\"\n\nimport { useTheme } from \"@emotion/react\"\nimport styled from \"@emotion/styled\"\nimport LockIcon from \"@mui/icons-material/Lock\"\nimport { Trans } from \"react-i18next\"\n\nimport LoadingCircle from \"@/common/components/LoadingCircle\"\nimport FlexWrapper from \"@/common/primitives/FlexWrapper\"\nimport Icon from \"@/common/primitives/Icon\"\nimport Typography from \"@/common/primitives/Typography\"\nimport type { Lecture } from \"@/common/schemas/lecture\"\nimport { media } from \"@/styles/themes/media\"\nimport { useAPI } from \"@/utils/api/useAPI\"\nimport { handleLogin } from \"@/utils/handleLoginLogout\"\nimport useUserStore from \"@/utils/zustand/useUserStore\"\n\nimport Widget from \"../../../../common/primitives/Widget\"\nimport CustomTimeTableGrid from \"../../components/CustomTimeTableGrid\"\n\nconst StyledWidget = styled(Widget)`\n    width: 856px;\n\n    ${media.laptop} {\n        width: 100%;\n    }\n`\n\nconst TimeTableInner = styled(FlexWrapper)`\n    flex-grow: 1;\n    width: 100%;\n`\n\nconst BlurWrapper = styled.div<{ blur: boolean }>`\n    filter: ${(props) => (props.blur ? \"blur(4px)\" : \"none\")};\n    width: 100%;\n    height: 100%;\n`\n\nconst LoginWrapper = styled(FlexWrapper)`\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    z-index: 10;\n`\n\nconst LockIconWrapper = styled.div`\n    width: 50px;\n    height: 50px;\n    border-radius: 100%;\n    border: 2px solid ${({ theme }) => theme.colors.Highlight.default};\n    padding: 8px;\n`\n\nconst LoginButton = styled.div`\n    padding: 8px 20px;\n    border-radius: 20px;\n    background-color: ${({ theme }) => theme.colors.Highlight.default};\n    cursor: pointer;\n    user-select: none;\n`\n\nconst TimeTableSection = () => {\n    const theme = useTheme()\n    const { user, status } = useUserStore()\n\n    const totalRef = useRef<HTMLDivElement>(null)\n    const [width, setWidth] = useState(0)\n\n    const [selected, setSelected] = useState<Lecture | null>(null)\n    const [hover, setHover] = useState<Lecture[] | null>(null)\n\n    const { query: myTimetable, setParams: setMyTimetableParams } = useAPI(\n        \"GET\",\n        \"/timetables/my-timetable\",\n        {\n            enabled: status === \"success\",\n        },\n    )\n    const { query: semesters } = useAPI(\"GET\", \"/semesters\")\n\n    useEffect(() => {\n        if (semesters.data && semesters.data.semesters.length > 0) {\n            const latestSemester =\n                semesters.data.semesters[semesters.data.semesters.length - 1]\n            if (!latestSemester) return\n            setMyTimetableParams({\n                year: latestSemester.year,\n                semester: latestSemester.semester,\n            } as never)\n        }\n    }, [semesters.data, setMyTimetableParams])\n\n    useEffect(() => {\n        const handleResize = () => {\n            if (totalRef.current) {\n                setWidth(totalRef.current.clientWidth)\n            }\n        }\n\n        window.addEventListener(\"resize\", handleResize)\n        handleResize()\n\n        return () => {\n            window.removeEventListener(\"resize\", handleResize)\n        }\n    }, [totalRef, status])\n\n    const lectures = myTimetable.data?.lectures ?? []\n\n    return (\n        <StyledWidget direction=\"column\" gap={0} padding=\"30px\" flex=\"1 1 auto\">\n            {status === \"loading\" ? (\n                <LoadingCircle />\n            ) : (\n                <TimeTableInner\n                    direction=\"column\"\n                    align=\"stretch\"\n                    gap={16}\n                    ref={totalRef}\n                >\n                    {status === \"idle\" ? (\n                        <LoginWrapper direction=\"column\" gap={12} align=\"center\">\n                            <LockIconWrapper>\n                                <Icon size={30} color={theme.colors.Highlight.default}>\n                                    <LockIcon />\n                                </Icon>\n                            </LockIconWrapper>\n                            <LoginButton onClick={handleLogin}>\n                                <Typography type=\"BigBold\" style={{ color: \"#FFFFFF\" }}>\n                                    로그인하러가기\n                                </Typography>\n                            </LoginButton>\n                        </LoginWrapper>\n                    ) : (\n                        <FlexWrapper direction=\"row\" gap={0}>\n                            <Trans\n                                i18nKey=\"main.hisTimeTable\"\n                                values={{ name: user?.name }}\n                                components={{\n                                    name: (\n                                        <Typography\n                                            type=\"BiggerBold\"\n                                            color=\"Highlight.default\"\n                                            children={undefined}\n                                        />\n                                    ),\n                                    normal: (\n                                        <Typography\n                                            type=\"BiggerBold\"\n                                            color=\"Text.dark\"\n                                            children={undefined}\n                                        />\n                                    ),\n                                    space: <>&nbsp;</>,\n                                }}\n                            />\n                        </FlexWrapper>\n                    )}\n                    <BlurWrapper blur={status === \"idle\"}>\n                        <CustomTimeTableGrid\n                            cellWidth={(width - 30) / 5}\n                            lectureSummary={lectures}\n                            hover={hover}\n                            setHover={setHover}\n                            selected={selected}\n                            setSelected={setSelected}\n                        />\n                    </BlurWrapper>\n                </TimeTableInner>\n            )}\n        </StyledWidget>\n    )\n}\n\nexport default TimeTableSection\n"],"names":["FULL_HEIGHT","ROWS","SectionWrapper","styled","TimeWrapper","theme","DateWrapper","GridContainer","CustomTimeTableGrid","cellWidth","lectureSummary","hover","setHover","selected","setSelected","t","useTranslation","colPadding","m","begin","gridRef","useRef","dateHeader","checkAnyOver24","n","end","cellHeight","cssVariables","useMemo","draggingArea","useState","_","rowIndex","grid","renderGrid","lectureTiles","renderLectureTile","handleClick","useCallback","jsxs","jsx","index","number","FlexWrapper","date","renderTargetArea","CustomTimeTableGrid$1","React","StyledWidget","Widget","media","TimeTableInner","BlurWrapper","props","LoginWrapper","LockIconWrapper","LoginButton","TimeTableSection","useTheme","user","status","useUserStore","totalRef","width","setWidth","myTimetable","setMyTimetableParams","useAPI","semesters","useEffect","latestSemester","handleResize","lectures","LoadingCircle","Icon","LockIcon","handleLogin","Typography","Trans"],"mappings":"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"}