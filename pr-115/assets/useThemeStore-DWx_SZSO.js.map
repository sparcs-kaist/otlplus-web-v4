{"version":3,"file":"useThemeStore-DWx_SZSO.js","sources":["../../../app/utils/localStorage.ts","../../../app/utils/zustand/useThemeStore.ts"],"sourcesContent":["// WARNING: MUST BE CALLED IN A BROWSER ENVIRONMENT\n\nconst LOCAL_STORAGE_SET_EVENT = \"local-storage-set\"\n\nexport const getLocalStorageItem = (key: string) =>\n    typeof window !== \"undefined\" ? localStorage.getItem(key) : null\n\nexport const setLocalStorageItem = (key: string, value: string) => {\n    localStorage.setItem(key, value)\n    window.dispatchEvent(new Event(LOCAL_STORAGE_SET_EVENT))\n}\n\nexport const removeLocalStorageItem = (key: string) => {\n    localStorage.removeItem(key)\n    window.dispatchEvent(new Event(LOCAL_STORAGE_SET_EVENT))\n}\n\nexport const subscribeLocalStorageSet = (callback: () => void) => {\n    window.addEventListener(LOCAL_STORAGE_SET_EVENT, callback)\n}\n\nexport const unsubscribeLocalStorageSet = (callback: () => void) => {\n    window.removeEventListener(LOCAL_STORAGE_SET_EVENT, callback)\n}\n","import { useEffect } from \"react\"\n\nimport { create } from \"zustand\"\n\nimport type { ThemeKeys } from \"@/styles/themes\"\nimport { getLocalStorageItem, setLocalStorageItem } from \"@/utils/localStorage\"\n\nexport type ThemeKeysWithSystem = ThemeKeys | \"system\"\n\nconst getSystemTheme = (): ThemeKeys => {\n    if (\n        typeof window !== \"undefined\" &&\n        window.matchMedia(\"(prefers-color-scheme: dark)\").matches\n    ) {\n        return \"dark\"\n    }\n    return \"light\"\n}\n\nconst resolveThemeSetting = (value: ThemeKeysWithSystem): ThemeKeys =>\n    value === \"system\" ? getSystemTheme() : value\n\nconst storedTheme =\n    (getLocalStorageItem(\"theme\") as ThemeKeysWithSystem | null) ?? \"system\"\n\ntype ThemeState = {\n    displayedTheme: ThemeKeys\n    themeSetting: ThemeKeysWithSystem\n    setTheme: (newTheme: ThemeKeysWithSystem) => void\n    setResolvedTheme: (resolvedTheme: ThemeKeys) => void\n}\n\nconst useThemeStoreBase = create<ThemeState>((set) => ({\n    themeSetting: storedTheme,\n    displayedTheme: resolveThemeSetting(storedTheme),\n    setTheme: (newTheme) => {\n        const resolvedTheme = resolveThemeSetting(newTheme)\n        if (typeof window !== \"undefined\") {\n            setLocalStorageItem(\"theme\", newTheme)\n        }\n        set({ themeSetting: newTheme, displayedTheme: resolvedTheme })\n    },\n    setResolvedTheme: (resolvedTheme) =>\n        set((state) =>\n            state.themeSetting === \"system\" ? { displayedTheme: resolvedTheme } : state,\n        ),\n}))\n\nconst useThemeStore = () => {\n    const { themeSetting, displayedTheme, setTheme, setResolvedTheme } =\n        useThemeStoreBase()\n\n    useEffect(() => {\n        if (themeSetting !== \"system\" || typeof window === \"undefined\") {\n            return\n        }\n\n        const mediaQuery = window.matchMedia(\"(prefers-color-scheme: dark)\")\n        const applySystemTheme = (event?: MediaQueryListEvent) => {\n            const isDark = event ? event.matches : mediaQuery.matches\n            setResolvedTheme(isDark ? \"dark\" : \"light\")\n        }\n\n        applySystemTheme()\n        mediaQuery.addEventListener(\"change\", applySystemTheme)\n        return () => mediaQuery.removeEventListener(\"change\", applySystemTheme)\n    }, [themeSetting, setResolvedTheme])\n\n    return { themeSetting, displayedTheme, setTheme }\n}\n\nexport default useThemeStore\n"],"names":["LOCAL_STORAGE_SET_EVENT","getLocalStorageItem","key","setLocalStorageItem","value","getSystemTheme","resolveThemeSetting","storedTheme","useThemeStoreBase","create","set","newTheme","resolvedTheme","state","useThemeStore","themeSetting","displayedTheme","setTheme","setResolvedTheme","useEffect","mediaQuery","applySystemTheme","event","isDark"],"mappings":"wfAEA,MAAMA,EAA0B,oBAEnBC,EAAuBC,GAChC,OAAO,OAAW,IAAc,aAAa,QAAQA,CAAG,EAAI,KAEnDC,EAAsB,CAACD,EAAaE,IAAkB,CAC/D,aAAa,QAAQF,EAAKE,CAAK,EAC/B,OAAO,cAAc,IAAI,MAAMJ,CAAuB,CAAC,CAC3D,ECDMK,EAAiB,IAEf,OAAO,OAAW,KAClB,OAAO,WAAW,8BAA8B,EAAE,QAE3C,OAEJ,QAGLC,EAAuBF,GACzBA,IAAU,SAAWC,IAAmBD,EAEtCG,EACDN,EAAoB,OAAO,GAAoC,SAS9DO,EAAoBC,EAAoBC,IAAS,CACnD,aAAcH,EACd,eAAgBD,EAAoBC,CAAW,EAC/C,SAAWI,GAAa,CACpB,MAAMC,EAAgBN,EAAoBK,CAAQ,EAC9C,OAAO,OAAW,KAClBR,EAAoB,QAASQ,CAAQ,EAEzCD,EAAI,CAAE,aAAcC,EAAU,eAAgBC,EAAe,CACjE,EACA,iBAAmBA,GACfF,EAAKG,GACDA,EAAM,eAAiB,SAAW,CAAE,eAAgBD,GAAkBC,CAAA,CAElF,EAAE,EAEIC,EAAgB,IAAM,CACxB,KAAM,CAAE,aAAAC,EAAc,eAAAC,EAAgB,SAAAC,EAAU,iBAAAC,CAAA,EAC5CV,EAAA,EAEJW,OAAAA,EAAAA,UAAU,IAAM,CACZ,GAAIJ,IAAiB,UAAY,OAAO,OAAW,IAC/C,OAGJ,MAAMK,EAAa,OAAO,WAAW,8BAA8B,EAC7DC,EAAoBC,GAAgC,CACtD,MAAMC,EAASD,EAAQA,EAAM,QAAUF,EAAW,QAClDF,EAAiBK,EAAS,OAAS,OAAO,CAC9C,EAEA,OAAAF,EAAA,EACAD,EAAW,iBAAiB,SAAUC,CAAgB,EAC/C,IAAMD,EAAW,oBAAoB,SAAUC,CAAgB,CAC1E,EAAG,CAACN,EAAcG,CAAgB,CAAC,EAE5B,CAAE,aAAAH,EAAc,eAAAC,EAAgB,SAAAC,CAAA,CAC3C"}