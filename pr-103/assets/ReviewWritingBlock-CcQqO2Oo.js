import{a as w,j as i}from"./emotion-react-jsx-runtime.browser.esm-CHRlxEmW.js";import{r as o}from"./chunk-EPOLDU6W-DHqJ36X5.js";import{n as S,F as l}from"./FlexWrapper-DN6X0kFV.js";import{u as W,t as E}from"./index-C2LeEscB.js";import{B as j}from"./media-ZJ5Z6TkX.js";import{T as C,G as I}from"./TextInputArea-CVHOQB1h.js";import{u as R,k as P,q as _}from"./useIsDevice-cU7PV1GL.js";import{T as m}from"./Typography-Dcdi3KtC.js";import{p as D}from"./ReviewBlock-DIINwsGe.js";import{u as L}from"./useUserStore-BFtmcw-P.js";import{u as A}from"./useTranslation-BKC8VvFf.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};e.SENTRY_RELEASE={id:"f01aa4f6c8c6bcbf757497f9da443abfac01c7c9"}}catch{}})();try{(function(){var e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},r=new e.Error().stack;r&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[r]="82c233c7-9a88-4bd3-b599-ca886d5383c0",e._sentryDebugIdIdentifier="sentry-dbid-82c233c7-9a88-4bd3-b599-ca886d5383c0")})()}catch{}const U=S(l)`
    padding: 8px 10px;
    width: 100%;
    border-radius: 6px;
    border: 1px ${({theme:e})=>e.colors.Background.Block.dark} solid;
    background-color: ${({theme:e})=>e.colors.Background.Block.default};
`,M=S(l)`
    height: 160px;
`,O=S(l)`
    flex-wrap: wrap;
`;function se({name:e,lectureId:r,professors:k,year:Q,semester:B}){const{t:n}=A(),{user:T,status:N}=L(),s=W(),[t,x]=o.useState(null),{requestFunction:K}=R("POST","/reviews",{onSuccess:()=>{s.invalidateQueries({queryKey:["/reviews"]}),s.invalidateQueries({queryKey:[`/users/${T?.id}/lectures`]}),s.invalidateQueries({queryKey:["/users/written-reviews"]}),s.invalidateQueries({queryKey:["/users/writable-review"]})}}),{requestFunction:G}=R("PUT",`/reviews/${t?.id}`,{onSuccess:()=>{s.invalidateQueries({queryKey:["/reviews"]}),s.invalidateQueries({queryKey:[`/users/${T?.id}/lectures`]}),s.invalidateQueries({queryKey:["/users/written-reviews"]}),s.invalidateQueries({queryKey:["/users/writable-review"]})}}),{query:y}=R("GET","/users/written-reviews",{enabled:N==="success"});o.useEffect(()=>{if(y.data){const a=y.data.reviews.find(p=>p.lectureId===r);x(a||null)}},[y.data,r]);const[f,v]=o.useState(""),[c,g]=o.useState(0),[d,h]=o.useState(0),[u,b]=o.useState(0);function q(){v(""),g(0),h(0),b(0)}o.useEffect(()=>{q()},[r]),o.useEffect(()=>{t?(v(t.content),g(t.grade),h(t.load),b(t.speech)):q()},[t]);function $(){t?(G({content:f,grade:c,load:d,speech:u}),E("Edit Review",{reviewId:t.id,lectureId:r,courseName:e,grade:c,load:d,speech:u})):(K({lectureId:r,content:f,grade:c,load:d,speech:u}),E("Submit Review",{lectureId:r,courseName:e,grade:c,load:d,speech:u}))}return w(U,{direction:"column",gap:8,align:"stretch",children:[w(l,{direction:"row",gap:6,align:"center",children:[i(m,{type:"NormalBold",color:"Text.default",children:e}),[D(k),Q,P(B||_.SPRING)].map((a,p)=>i(m,{type:"Normal",color:"Text.lighter",children:a},p))]}),i(M,{direction:"column",gap:0,justify:"stretch",align:"stretch",children:i(C,{placeholder:n("common.review.writingPlaceholder"),value:f,handleChange:v,area:!0})}),w(l,{direction:"row",gap:20,justify:"space-between",align:"center",children:[i(O,{direction:"row",gap:12,children:[[n("common.grade"),c,g],[n("common.load"),d,h],[n("common.speech"),u,b]].map(([a,p,F])=>w(l,{direction:"row",gap:6,align:"center",children:[i(m,{type:"Normal",color:"Text.default",children:a}),i(I,{score:p,setScore:F})]},a))}),i(j,{type:f&&c&&u&&d?"selected":"disabled",$paddingLeft:8,$paddingTop:8,onClick:$,children:i(m,{type:"Normal",children:n(t?"writeReviews.write.edit":"common.upload")})})]})]})}export{se as R};
//# sourceMappingURL=ReviewWritingBlock-CcQqO2Oo.js.map
