import{_ as y}from"./preload-helper-DAa0bR2P.js";import{c as m}from"./env-C21WfMNR.js";const i=m.VITE_MIXPANEL_TOKEN;let a=!1,d=null;const c=async()=>typeof window>"u"?null:(d||(d=(await y(()=>import("./mixpanel.module-gGz72Awa.js"),[])).default),d),h=async()=>{if(typeof window>"u"||!i||a)return;const e=await c();e&&(e.init(i,{debug:!1,track_pageview:!0,persistence:"localStorage",autocapture:!0,record_sessions_percent:100}),a=!0)},k=async e=>{if(typeof window>"u"||!i||!a)return;const t=await c();t&&(t.identify(e.id.toString()),t.people.set({$email:e.email,$name:e.name,student_number:e.studentNumber,degree:e.degree}))},C=async()=>{if(typeof window>"u"||!i||!a)return;const e=await c();e&&e.reset()},D=async(e,t)=>{if(typeof window>"u"||!i||!a)return;const n=await c();n&&n.track(e,t)};function s(e){return new Promise((t,n)=>{e.oncomplete=e.onsuccess=()=>t(e.result),e.onabort=e.onerror=()=>n(e.error)})}function _(e,t){let n;const o=()=>{if(n)return n;const r=indexedDB.open(e);return r.onupgradeneeded=()=>r.result.createObjectStore(t),n=s(r),n.then(u=>{u.onclose=()=>n=void 0},()=>{}),n};return(r,u)=>o().then(w=>u(w.transaction(t,r).objectStore(t)))}let f;function p(){return f||(f=_("keyval-store","keyval")),f}function g(e,t=p()){return t("readonly",n=>s(n.get(e)))}function v(e,t,n=p()){return n("readwrite",o=>(o.put(t,e),s(o.transaction)))}function E(e,t=p()){return t("readwrite",n=>(n.delete(e),s(n.transaction)))}const l="otlplus-query-cache";function b(e){return JSON.stringify(e)}function x(e){return JSON.parse(e)}function S(){return{persistClient:async e=>{const t=b(e);await v(l,t)},restoreClient:async()=>{const e=await g(l);if(e)return x(e)},removeClient:async()=>{await E(l)}}}const I=S();async function N(){await I.removeClient()}export{h as a,k as b,N as c,I as i,C as r,D as t};
//# sourceMappingURL=queryPersister-Dbez1CJ4.js.map
