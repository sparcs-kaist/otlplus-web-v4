import{w as y,y as g,r as m}from"./chunk-UIGDSWPH-ClhI_Z4l.js";import{u as p,b as n}from"./index-fEVa9lK7.js";import{c as d}from"./queryPersister-CY7DFGkL.js";import{u as w}from"./useTranslation-DrmvPmDd.js";import"./env-DH6Q4_Mp.js";const Q=y(function(){const a=g(),s=p(),{i18n:o}=w(),t=m.useRef(!0);return m.useEffect(()=>(t.current=!0,(async()=>{const h=window.location.hash.substring(1),c=new URLSearchParams(h),i=c.get("accessToken"),u=c.get("refreshToken"),l=o.resolvedLanguage||"ko";if(i&&u){if(navigator.userAgent.includes("otl-app")){window.location.href=`org.sparcs.otl://login?accessToken=${i}&refreshToken=${u}`;return}await d(),s.removeQueries({queryKey:["/users/info"]}),s.removeQueries({queryKey:["/timetables"]}),await s.prefetchQuery({queryKey:["/users/info",null,l],queryFn:async()=>{const{data:e}=await n.get("/api/v2/users/info",{headers:{"Cache-Control":"no-cache"}});return e}});try{const{data:e}=await n.get("/api/v2/semesters",{headers:{"Cache-Control":"no-cache"}});if(e?.semesters?.length>0){const r=e.semesters[e.semesters.length-1];r&&await s.prefetchQuery({queryKey:["/timetables/my-timetable",{year:r.year,semester:r.semester},l],queryFn:async()=>{const{data:f}=await n.get("/api/v2/timetables/my-timetable",{params:{year:r.year,semester:r.semester},headers:{"Cache-Control":"no-cache"}});return f}})}}catch(e){console.error("Failed to prefetch timetable:",e)}t.current&&a("/",{replace:!0})}else t.current&&a("/",{replace:!0})})(),()=>{t.current=!1}),[a,s,o.resolvedLanguage]),null});export{Q as default};
//# sourceMappingURL=login.success-Bkk9MnG7.js.map
