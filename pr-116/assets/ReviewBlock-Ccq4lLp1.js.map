{"version":3,"file":"ReviewBlock-Ccq4lLp1.js","sources":["../../../node_modules/.pnpm/@mui+icons-material@7.3.8_@mui+material@7.3.8_@emotion+react@11.14.0_@types+react@19.2._eea1b8ae36d0998f6630ee1e4377c145/node_modules/@mui/icons-material/esm/Favorite.js","../../../node_modules/.pnpm/@mui+icons-material@7.3.8_@mui+material@7.3.8_@emotion+react@11.14.0_@types+react@19.2._eea1b8ae36d0998f6630ee1e4377c145/node_modules/@mui/icons-material/esm/FavoriteBorderOutlined.js","../../../app/utils/professorName.ts","../../../app/common/components/reviews/ReviewBlock.tsx"],"sourcesContent":["\"use client\";\n\nimport createSvgIcon from \"./utils/createSvgIcon.js\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon(/*#__PURE__*/_jsx(\"path\", {\n  d: \"m12 21.35-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54z\"\n}), 'Favorite');","\"use client\";\n\nimport createSvgIcon from \"./utils/createSvgIcon.js\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon(/*#__PURE__*/_jsx(\"path\", {\n  d: \"M16.5 3c-1.74 0-3.41.81-4.5 2.09C10.91 3.81 9.24 3 7.5 3 4.42 3 2 5.42 2 8.5c0 3.78 3.4 6.86 8.55 11.54L12 21.35l1.45-1.32C18.6 15.36 22 12.28 22 8.5 22 5.42 19.58 3 16.5 3m-4.4 15.55-.1.1-.1-.1C7.14 14.24 4 11.39 4 8.5 4 6.5 5.5 5 7.5 5c1.54 0 3.04.99 3.57 2.36h1.87C13.46 5.99 14.96 5 16.5 5c2 0 3.5 1.5 3.5 3.5 0 2.89-3.14 5.74-7.9 10.05\"\n}), 'FavoriteBorderOutlined');","import i18n from \"i18next\"\n\nimport { type Professor } from \"@/common/schemas/professor\"\n\nfunction professorName(professors: Professor[]): string {\n    if (!professors) return \"\"\n    if (professors.length === 0) return \"\"\n    return `${professors[0]?.name}${professors.length > 1 ? i18n.t(\"common.professors.over\") + (professors.length - 1) + i18n.t(\"common.professors.people\") : \"\"}`\n}\n\nexport default professorName\n","import { memo, useMemo, useState } from \"react\"\n\nimport styled from \"@emotion/styled\"\nimport FavoriteIcon from \"@mui/icons-material/Favorite\"\nimport FavoriteBorderOutlinedIcon from \"@mui/icons-material/FavoriteBorderOutlined\"\nimport { useTranslation } from \"react-i18next\"\nimport { useNavigate } from \"react-router\"\n\nimport { ScoreEnum } from \"@/common/enum/scoreEnum\"\nimport { semesterToString } from \"@/common/enum/semesterEnum\"\nimport FlexWrapper from \"@/common/primitives/FlexWrapper\"\nimport Icon from \"@/common/primitives/Icon\"\nimport Typography from \"@/common/primitives/Typography\"\nimport { type Review } from \"@/common/schemas/review\"\nimport { useAPI } from \"@/utils/api/useAPI\"\nimport professorName from \"@/utils/professorName\"\nimport useUserStore from \"@/utils/zustand/useUserStore\"\n\nconst Content = styled(Typography)<{ overflow: boolean }>`\n    line-height: 1.5;\n    width: 100%;\n\n    word-break: break-word;\n    ${(props) =>\n        props.overflow &&\n        `\n        text-overflow: ellipsis;\n        overflow: hidden;\n        word-break: break-word;\n        \n        display: -webkit-box;\n        -webkit-line-clamp: 5;\n        -webkit-box-orient: vertical;\n    `}\n`\n\nconst ReviewWrapper = styled.div<{ clickable: boolean }>`\n    padding: 8px 6px;\n    width: 100%;\n    border-radius: 6px;\n    border: 1px ${({ theme }) => theme.colors.Background.Block.dark} solid;\n    background-color: ${({ theme }) => theme.colors.Background.Block.default};\n\n    &:hover {\n        background-color: ${(props) =>\n            props.clickable\n                ? props.theme.colors.Background.Block.dark\n                : props.theme.colors.Background.Block.default};\n    }\n`\n\nconst SelectWrapper = styled(FlexWrapper)<{ clickable: boolean }>`\n    width: 100%;\n    cursor: ${(props) => (props.clickable ? \"pointer\" : \"auto\")};\n    user-select: ${(props) => (props.clickable ? \"none\" : \"auto\")};\n`\n\nconst LikeButtonWrapper = styled(FlexWrapper)<{ nonLogin: boolean }>`\n    cursor: ${({ nonLogin }) => (nonLogin ? \"not-allowed\" : \"pointer\")};\n    opacity: ${({ nonLogin }) => (nonLogin ? 0.5 : 1)};\n    color: ${({ theme, nonLogin }) =>\n        nonLogin ? theme.colors.Text.disable : theme.colors.Highlight.default};\n`\n\ninterface ReviewBlockProps {\n    review: Review\n    withWrapper?: boolean\n    linkToDictionary?: boolean\n}\n\nfunction ReviewBlock({\n    review,\n    withWrapper = true,\n    linkToDictionary = true,\n}: ReviewBlockProps) {\n    const { t } = useTranslation()\n    const { status } = useUserStore()\n    const navigator = useNavigate()\n\n    const { query: userReviewsQuery } = useAPI(\"GET\", `/users/written-reviews`, {\n        enabled: status === \"success\",\n    })\n\n    const { requestFunction } = useAPI(\"PATCH\", `/reviews/${review.id}/liked`, {\n        onSuccess: () => {\n            setLikeOverride((prev) => {\n                if (prev === null) {\n                    return !review.likedByUser\n                } else {\n                    return !prev\n                }\n            })\n        },\n    })\n\n    const [likeOverride, setLikeOverride] = useState<boolean | null>(null)\n\n    const writtenReviewIds: number[] = useMemo(() => {\n        if (userReviewsQuery.data) {\n            return userReviewsQuery.data.reviews.map((rev: Review) => rev.id)\n        }\n        return []\n    }, [userReviewsQuery.data])\n\n    if (!review) return null\n\n    const likeReview = (e: React.MouseEvent) => {\n        e.stopPropagation()\n        if (status !== \"success\") return\n        requestFunction({\n            reviewId: review.id,\n            action: (likeOverride ?? review.likedByUser) ? \"unlike\" : \"like\",\n        })\n    }\n\n    const reviewContent = (\n        <SelectWrapper\n            direction=\"column\"\n            align=\"stretch\"\n            gap={8}\n            padding=\"3px 4px 0px 4px\"\n            clickable={linkToDictionary}\n            onClick={() => {\n                if (linkToDictionary) {\n                    navigator(\n                        `/dictionary?courseId=${review.courseId}&professorId=${review.professors[0]?.id ?? \"\"}`,\n                    )\n                }\n            }}\n        >\n            <FlexWrapper direction=\"column\" gap={8}>\n                <FlexWrapper direction=\"row\" gap={6} style={{ wordBreak: \"keep-all\" }}>\n                    <Typography type=\"NormalBold\" color=\"Text.default\">\n                        {review.courseName}\n                    </Typography>\n                    <Typography type=\"Normal\" color=\"Text.lighter\">\n                        {professorName(review.professors)}\n                    </Typography>\n                    <Typography type=\"Normal\" color=\"Text.lighter\">\n                        {review.year} {semesterToString(review.semester)}\n                    </Typography>\n                </FlexWrapper>\n                <FlexWrapper direction=\"row\" gap={0} style={{ overflow: \"hidden\" }}>\n                    <Content type=\"Normal\" color=\"Text.default\" overflow={!withWrapper}>\n                        {review.content}\n                    </Content>\n                </FlexWrapper>\n            </FlexWrapper>\n\n            <FlexWrapper direction=\"row\" justify=\"space-between\" align=\"center\" gap={0}>\n                <FlexWrapper direction=\"row\" gap={8}>\n                    <Typography type=\"Normal\" color=\"Text.lighter\">\n                        {t(\"common.review.like\")} {review.like}\n                    </Typography>\n                    <Typography type=\"Normal\" color=\"Text.lighter\">\n                        {t(\"common.grade\")} {ScoreEnum[review.grade]}\n                    </Typography>\n                    <Typography type=\"Normal\" color=\"Text.lighter\">\n                        {t(\"common.load\")} {ScoreEnum[review.load]}\n                    </Typography>\n                    <Typography type=\"Normal\" color=\"Text.lighter\">\n                        {t(\"common.speech\")} {ScoreEnum[review.speech]}\n                    </Typography>\n                </FlexWrapper>\n                {!writtenReviewIds.includes(review.id) && (\n                    <LikeButtonWrapper\n                        direction=\"row\"\n                        gap={4}\n                        align=\"center\"\n                        onClick={(e) => likeReview(e)}\n                        nonLogin={status !== \"success\"}\n                    >\n                        <Typography type=\"Normal\">{t(\"common.review.like\")}</Typography>\n                        <Icon size={18}>\n                            {(likeOverride ?? review.likedByUser) ? (\n                                <FavoriteIcon />\n                            ) : (\n                                <FavoriteBorderOutlinedIcon />\n                            )}\n                        </Icon>\n                    </LikeButtonWrapper>\n                )}\n            </FlexWrapper>\n        </SelectWrapper>\n    )\n\n    if (withWrapper) {\n        return <ReviewWrapper clickable={linkToDictionary}>{reviewContent}</ReviewWrapper>\n    } else return reviewContent\n}\n\nexport default memo(ReviewBlock)\n"],"names":["FavoriteIcon","createSvgIcon","_jsx","FavoriteBorderOutlined","professorName","professors","i18n","Content","styled","Typography","props","ReviewWrapper","theme","SelectWrapper","FlexWrapper","LikeButtonWrapper","nonLogin","ReviewBlock","review","withWrapper","linkToDictionary","t","useTranslation","status","useUserStore","navigator","useNavigate","userReviewsQuery","useAPI","requestFunction","setLikeOverride","prev","likeOverride","useState","writtenReviewIds","useMemo","rev","likeReview","e","reviewContent","jsxs","jsx","semesterToString","ScoreEnum","Icon","FavoriteBorderOutlinedIcon","ReviewBlock$1","memo"],"mappings":"2zBAIA,MAAAA,EAAeC,EAA2BC,EAAAA,IAAK,OAAQ,CACrD,EAAG,sKACL,CAAC,CAAa,ECFdC,EAAeF,EAA2BC,EAAAA,IAAK,OAAQ,CACrD,EAAG,sVACL,CAAC,CAA2B,ECF5B,SAASE,EAAcC,EAAiC,CAEpD,MADI,CAACA,GACDA,EAAW,SAAW,EAAU,GAC7B,GAAGA,EAAW,CAAC,GAAG,IAAI,GAAGA,EAAW,OAAS,EAAIC,EAAK,EAAE,wBAAwB,GAAKD,EAAW,OAAS,GAAKC,EAAK,EAAE,0BAA0B,EAAI,EAAE,EAChK,CCUA,MAAMC,EAAUC,EAAOC,CAAU;AAAA;AAAA;AAAA;AAAA;AAAA,MAK1BC,GACCA,EAAM,UACN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAQH;AAAA,EAGCC,EAAgBH,EAAO;AAAA;AAAA;AAAA;AAAA,kBAIX,CAAC,CAAE,MAAAI,KAAYA,EAAM,OAAO,WAAW,MAAM,IAAI;AAAA,wBAC3C,CAAC,CAAE,MAAAA,KAAYA,EAAM,OAAO,WAAW,MAAM,OAAO;AAAA;AAAA;AAAA,4BAG/CF,GACjBA,EAAM,UACAA,EAAM,MAAM,OAAO,WAAW,MAAM,KACpCA,EAAM,MAAM,OAAO,WAAW,MAAM,OAAO;AAAA;AAAA,EAIvDG,EAAgBL,EAAOM,CAAW;AAAA;AAAA,cAEzBJ,GAAWA,EAAM,UAAY,UAAY,MAAO;AAAA,mBAC3CA,GAAWA,EAAM,UAAY,OAAS,MAAO;AAAA,EAG3DK,EAAoBP,EAAOM,CAAW;AAAA,cAC9B,CAAC,CAAE,SAAAE,CAAA,IAAgBA,EAAW,cAAgB,SAAU;AAAA,eACvD,CAAC,CAAE,SAAAA,CAAA,IAAgBA,EAAW,GAAM,CAAE;AAAA,aACxC,CAAC,CAAE,MAAAJ,EAAO,SAAAI,CAAA,IACfA,EAAWJ,EAAM,OAAO,KAAK,QAAUA,EAAM,OAAO,UAAU,OAAO;AAAA,EAS7E,SAASK,EAAY,CACjB,OAAAC,EACA,YAAAC,EAAc,GACd,iBAAAC,EAAmB,EACvB,EAAqB,CACjB,KAAM,CAAE,EAAAC,CAAA,EAAMC,EAAA,EACR,CAAE,OAAAC,CAAA,EAAWC,EAAA,EACbC,EAAYC,EAAA,EAEZ,CAAE,MAAOC,CAAA,EAAqBC,EAAO,MAAO,yBAA0B,CACxE,QAASL,IAAW,SAAA,CACvB,EAEK,CAAE,gBAAAM,GAAoBD,EAAO,QAAS,YAAYV,EAAO,EAAE,SAAU,CACvE,UAAW,IAAM,CACbY,EAAiBC,GACTA,IAAS,KACF,CAACb,EAAO,YAER,CAACa,CAEf,CACL,CAAA,CACH,EAEK,CAACC,EAAcF,CAAe,EAAIG,EAAAA,SAAyB,IAAI,EAE/DC,EAA6BC,EAAAA,QAAQ,IACnCR,EAAiB,KACVA,EAAiB,KAAK,QAAQ,IAAKS,GAAgBA,EAAI,EAAE,EAE7D,CAAA,EACR,CAACT,EAAiB,IAAI,CAAC,EAE1B,GAAI,CAACT,EAAQ,OAAO,KAEpB,MAAMmB,EAAcC,GAAwB,CACxCA,EAAE,gBAAA,EACEf,IAAW,WACfM,EAAgB,CACZ,SAAUX,EAAO,GACjB,OAASc,GAAgBd,EAAO,YAAe,SAAW,MAAA,CAC7D,CACL,EAEMqB,EACFC,EAAC3B,EAAA,CACG,UAAU,SACV,MAAM,UACN,IAAK,EACL,QAAQ,kBACR,UAAWO,EACX,QAAS,IAAM,CACPA,GACAK,EACI,wBAAwBP,EAAO,QAAQ,gBAAgBA,EAAO,WAAW,CAAC,GAAG,IAAM,EAAE,EAAA,CAGjG,EAEA,SAAA,CAAAsB,EAAC1B,EAAA,CAAY,UAAU,SAAS,IAAK,EACjC,SAAA,CAAA0B,EAAC1B,EAAA,CAAY,UAAU,MAAM,IAAK,EAAG,MAAO,CAAE,UAAW,UAAA,EACrD,SAAA,CAAA2B,EAAChC,GAAW,KAAK,aAAa,MAAM,eAC/B,WAAO,WACZ,EACAgC,EAAChC,GAAW,KAAK,SAAS,MAAM,eAC3B,SAAAL,EAAcc,EAAO,UAAU,CAAA,CACpC,EACAsB,EAAC/B,EAAA,CAAW,KAAK,SAAS,MAAM,eAC3B,SAAA,CAAAS,EAAO,KAAK,IAAEwB,EAAiBxB,EAAO,QAAQ,CAAA,CAAA,CACnD,CAAA,EACJ,EACAuB,EAAC3B,GAAY,UAAU,MAAM,IAAK,EAAG,MAAO,CAAE,SAAU,QAAA,EACpD,WAACP,EAAA,CAAQ,KAAK,SAAS,MAAM,eAAe,SAAU,CAACY,EAClD,SAAAD,EAAO,OAAA,CACZ,CAAA,CACJ,CAAA,EACJ,EAEAsB,EAAC1B,GAAY,UAAU,MAAM,QAAQ,gBAAgB,MAAM,SAAS,IAAK,EACrE,SAAA,CAAA0B,EAAC1B,EAAA,CAAY,UAAU,MAAM,IAAK,EAC9B,SAAA,CAAA0B,EAAC/B,EAAA,CAAW,KAAK,SAAS,MAAM,eAC3B,SAAA,CAAAY,EAAE,oBAAoB,EAAE,IAAEH,EAAO,IAAA,EACtC,EACAsB,EAAC/B,EAAA,CAAW,KAAK,SAAS,MAAM,eAC3B,SAAA,CAAAY,EAAE,cAAc,EAAE,IAAEsB,EAAUzB,EAAO,KAAK,CAAA,EAC/C,EACAsB,EAAC/B,EAAA,CAAW,KAAK,SAAS,MAAM,eAC3B,SAAA,CAAAY,EAAE,aAAa,EAAE,IAAEsB,EAAUzB,EAAO,IAAI,CAAA,EAC7C,EACAsB,EAAC/B,EAAA,CAAW,KAAK,SAAS,MAAM,eAC3B,SAAA,CAAAY,EAAE,eAAe,EAAE,IAAEsB,EAAUzB,EAAO,MAAM,CAAA,CAAA,CACjD,CAAA,EACJ,EACC,CAACgB,EAAiB,SAAShB,EAAO,EAAE,GACjCsB,EAACzB,EAAA,CACG,UAAU,MACV,IAAK,EACL,MAAM,SACN,QAAUuB,GAAMD,EAAWC,CAAC,EAC5B,SAAUf,IAAW,UAErB,SAAA,CAAAkB,EAAChC,EAAA,CAAW,KAAK,SAAU,SAAAY,EAAE,oBAAoB,EAAE,EACnDoB,EAACG,EAAA,CAAK,KAAM,GACN,SAAAZ,GAAgBd,EAAO,YACrBuB,EAACzC,EAAA,CAAA,CAAa,EAEdyC,EAACI,EAAA,CAAA,CAA2B,CAAA,CAEpC,CAAA,CAAA,CAAA,CACJ,CAAA,CAER,CAAA,CAAA,CAAA,EAIR,OAAI1B,EACOsB,EAAC9B,EAAA,CAAc,UAAWS,EAAmB,SAAAmB,EAAc,EACxDA,CAClB,CAEA,MAAAO,EAAeC,EAAAA,KAAK9B,CAAW","x_google_ignoreList":[0,1]}