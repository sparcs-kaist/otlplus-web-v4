import{a as w,j as i}from"./emotion-react-jsx-runtime.browser.esm-B-zamEU7.js";import{r as o}from"./chunk-EPOLDU6W-zmgMqoXq.js";import{n as S,F as l}from"./FlexWrapper-Cxmg7ETU.js";import{u as F}from"./index-CrUTr-li.js";import{B as W}from"./media-gsTWNWmB.js";import{T as C,G as I}from"./TextInputArea-DZTh1m4W.js";import{u as R,j as P,l as _}from"./useAPI-B2f8YEht.js";import{T as m}from"./Typography-DoXk6ZeF.js";import{t as E}from"./index-_rQV4Sop.js";import{p as D}from"./ReviewBlock-BHYq_Ozo.js";import{u as L}from"./useUserStore-CPGET-uw.js";import{u as A}from"./useTranslation-BV_BGx8x.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};e.SENTRY_RELEASE={id:"ada4c7999b6ed5c9c18808775724ee3dffa94ca2"}}catch{}})();try{(function(){var e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},r=new e.Error().stack;r&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[r]="9f979bd5-8d8c-4824-a7c2-38564958d18e",e._sentryDebugIdIdentifier="sentry-dbid-9f979bd5-8d8c-4824-a7c2-38564958d18e")})()}catch{}const U=S(l)`
    padding: 8px 10px;
    width: 100%;
    border-radius: 6px;
    border: 1px ${({theme:e})=>e.colors.Background.Block.dark} solid;
    background-color: ${({theme:e})=>e.colors.Background.Block.default};
`,M=S(l)`
    height: 160px;
`,O=S(l)`
    flex-wrap: wrap;
`;function oe({name:e,lectureId:r,professors:k,year:Q,semester:B}){const{t:a}=A(),{user:T,status:N}=L(),s=F(),[t,x]=o.useState(null),{requestFunction:K}=R("POST","/reviews",{onSuccess:()=>{s.invalidateQueries({queryKey:["/reviews"]}),s.invalidateQueries({queryKey:[`/users/${T?.id}/lectures`]}),s.invalidateQueries({queryKey:["/users/written-reviews"]}),s.invalidateQueries({queryKey:["/users/writable-review"]})}}),{requestFunction:G}=R("PUT",`/reviews/${t?.id}`,{onSuccess:()=>{s.invalidateQueries({queryKey:["/reviews"]}),s.invalidateQueries({queryKey:[`/users/${T?.id}/lectures`]}),s.invalidateQueries({queryKey:["/users/written-reviews"]}),s.invalidateQueries({queryKey:["/users/writable-review"]})}}),{query:y}=R("GET","/users/written-reviews",{enabled:N==="success"});o.useEffect(()=>{if(y.data){const n=y.data.reviews.find(p=>p.lectureId===r);x(n||null)}},[y.data,r]);const[f,v]=o.useState(""),[d,g]=o.useState(0),[c,h]=o.useState(0),[u,b]=o.useState(0);function q(){v(""),g(0),h(0),b(0)}o.useEffect(()=>{q()},[r]),o.useEffect(()=>{t?(v(t.content),g(t.grade),h(t.load),b(t.speech)):q()},[t]);function $(){t?(G({content:f,grade:d,load:c,speech:u}),E("Edit Review",{reviewId:t.id,lectureId:r,courseName:e,grade:d,load:c,speech:u})):(K({lectureId:r,content:f,grade:d,load:c,speech:u}),E("Submit Review",{lectureId:r,courseName:e,grade:d,load:c,speech:u}))}return w(U,{direction:"column",gap:8,align:"stretch",children:[w(l,{direction:"row",gap:6,align:"center",children:[i(m,{type:"NormalBold",color:"Text.default",children:e}),[D(k),Q,P(B||_.SPRING)].map((n,p)=>i(m,{type:"Normal",color:"Text.lighter",children:n},p))]}),i(M,{direction:"column",gap:0,justify:"stretch",align:"stretch",children:i(C,{placeholder:a("common.review.writingPlaceholder"),value:f,handleChange:v,area:!0})}),w(l,{direction:"row",gap:20,justify:"space-between",align:"center",children:[i(O,{direction:"row",gap:12,children:[[a("common.grade"),d,g],[a("common.load"),c,h],[a("common.speech"),u,b]].map(([n,p,j])=>w(l,{direction:"row",gap:6,align:"center",children:[i(m,{type:"Normal",color:"Text.default",children:n}),i(I,{score:p,setScore:j})]},n))}),i(W,{type:f&&d&&u&&c?"selected":"disabled",$paddingLeft:8,$paddingTop:8,onClick:$,children:i(m,{type:"Normal",children:a(t?"writeReviews.write.edit":"common.upload")})})]})]})}export{oe as R};
//# sourceMappingURL=ReviewWritingBlock-mWjOq3cG.js.map
