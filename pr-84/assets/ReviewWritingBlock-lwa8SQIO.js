import{a as w,j as i}from"./emotion-react-jsx-runtime.browser.esm-DFzYZ-QR.js";import{r as a}from"./chunk-EPOLDU6W-C26KWm57.js";import{n as S,F as l}from"./FlexWrapper-BvLMhTg9.js";import{u as W,t as E}from"./index-DJcL_Y3p.js";import{B as j}from"./media-7lMfdZUr.js";import{T as C,G as I}from"./TextInputArea-BZV9qUDg.js";import{u as R,k as P,q as _}from"./useIsDevice-bKrxsj5W.js";import{T as m}from"./Typography-BoGuhcU2.js";import{p as D}from"./ReviewBlock-CBqfyQOs.js";import{u as L}from"./useUserStore-BFu1XcNS.js";import{u as A}from"./useTranslation-C1XzXuIC.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};e.SENTRY_RELEASE={id:"9d9be90128047a9adae01cbf529ac6e8d6d01bc1"}}catch{}})();try{(function(){var e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},r=new e.Error().stack;r&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[r]="9a4effa3-fbaa-4143-9d57-5f84b302da92",e._sentryDebugIdIdentifier="sentry-dbid-9a4effa3-fbaa-4143-9d57-5f84b302da92")})()}catch{}const U=S(l)`
    padding: 8px 10px;
    width: 100%;
    border-radius: 6px;
    border: 1px ${({theme:e})=>e.colors.Background.Block.dark} solid;
    background-color: ${({theme:e})=>e.colors.Background.Block.default};
`,M=S(l)`
    height: 160px;
`,O=S(l)`
    flex-wrap: wrap;
`;function se({name:e,lectureId:r,professors:k,year:Q,semester:B}){const{t:n}=A(),{user:T,status:N}=L(),s=W(),[t,x]=a.useState(null),{requestFunction:K}=R("POST","/reviews",{onSuccess:()=>{s.invalidateQueries({queryKey:["/reviews"]}),s.invalidateQueries({queryKey:[`/users/${T?.id}/lectures`]}),s.invalidateQueries({queryKey:["/users/written-reviews"]}),s.invalidateQueries({queryKey:["/users/writable-review"]})}}),{requestFunction:G}=R("PUT",`/reviews/${t?.id}`,{onSuccess:()=>{s.invalidateQueries({queryKey:["/reviews"]}),s.invalidateQueries({queryKey:[`/users/${T?.id}/lectures`]}),s.invalidateQueries({queryKey:["/users/written-reviews"]}),s.invalidateQueries({queryKey:["/users/writable-review"]})}}),{query:y}=R("GET","/users/written-reviews",{enabled:N==="success"});a.useEffect(()=>{if(y.data){const o=y.data.reviews.find(p=>p.lectureId===r);x(o||null)}},[y.data,r]);const[f,v]=a.useState(""),[d,g]=a.useState(0),[c,h]=a.useState(0),[u,b]=a.useState(0);function q(){v(""),g(0),h(0),b(0)}a.useEffect(()=>{q()},[r]),a.useEffect(()=>{t?(v(t.content),g(t.grade),h(t.load),b(t.speech)):q()},[t]);function $(){t?(G({content:f,grade:d,load:c,speech:u}),E("Edit Review",{reviewId:t.id,lectureId:r,courseName:e,grade:d,load:c,speech:u})):(K({lectureId:r,content:f,grade:d,load:c,speech:u}),E("Submit Review",{lectureId:r,courseName:e,grade:d,load:c,speech:u}))}return w(U,{direction:"column",gap:8,align:"stretch",children:[w(l,{direction:"row",gap:6,align:"center",children:[i(m,{type:"NormalBold",color:"Text.default",children:e}),[D(k),Q,P(B||_.SPRING)].map((o,p)=>i(m,{type:"Normal",color:"Text.lighter",children:o},p))]}),i(M,{direction:"column",gap:0,justify:"stretch",align:"stretch",children:i(C,{placeholder:n("common.review.writingPlaceholder"),value:f,handleChange:v,area:!0})}),w(l,{direction:"row",gap:20,justify:"space-between",align:"center",children:[i(O,{direction:"row",gap:12,children:[[n("common.grade"),d,g],[n("common.load"),c,h],[n("common.speech"),u,b]].map(([o,p,F])=>w(l,{direction:"row",gap:6,align:"center",children:[i(m,{type:"Normal",color:"Text.default",children:o}),i(I,{score:p,setScore:F})]},o))}),i(j,{type:f&&d&&u&&c?"selected":"disabled",$paddingLeft:8,$paddingTop:8,onClick:$,children:i(m,{type:"Normal",children:n(t?"writeReviews.write.edit":"common.upload")})})]})]})}export{se as R};
//# sourceMappingURL=ReviewWritingBlock-lwa8SQIO.js.map
