import{a as f,j as i}from"./emotion-react-jsx-runtime.browser.esm-s0EMl4AO.js";import{r as o}from"./chunk-JZWAC4HX-TAoMggkv.js";import{s as x,F as l}from"./FlexWrapper-B0XMReN0.js";import{u as W,t as k}from"./index-DbMdU-sj.js";import{B as j}from"./media-DiivD1zf.js";import{T as C,G as I}from"./TextInputArea-Bkn_w2LW.js";import{u as R,k as P,q as _}from"./useIsDevice-B5Irgies.js";import{T as m}from"./Typography-Dm8RpMVF.js";import{p as D}from"./ReviewBlock-BVf-WN1W.js";import{u as L}from"./useUserStore-Dat7usPV.js";import{u as A}from"./useTranslation-Cy2VYvGV.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};e.SENTRY_RELEASE={id:"21f91675e321c38140c99a330b90b599d74962c1"};var t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="47f0e5b5-456d-411b-9d4e-7f9d5c5bfa05",e._sentryDebugIdIdentifier="sentry-dbid-47f0e5b5-456d-411b-9d4e-7f9d5c5bfa05")}catch{}})();const U=x(l)`
    padding: 8px 10px;
    width: 100%;
    border-radius: 6px;
    border: 1px ${({theme:e})=>e.colors.Background.Block.dark} solid;
    background-color: ${({theme:e})=>e.colors.Background.Block.default};
`,M=x(l)`
    height: 160px;
`,O=x(l)`
    flex-wrap: wrap;
`;function se({name:e,lectureId:t,professors:S,year:Q,semester:B}){const{t:n}=A(),{user:T,status:N}=L(),s=W(),[r,q]=o.useState(null),{requestFunction:K}=R("POST","/reviews",{onSuccess:()=>{s.invalidateQueries({queryKey:["/reviews"]}),s.invalidateQueries({queryKey:[`/users/${T?.id}/lectures`]}),s.invalidateQueries({queryKey:["/users/written-reviews"]}),s.invalidateQueries({queryKey:["/users/writable-review"]})}}),{requestFunction:G}=R("PUT",`/reviews/${r?.id}`,{onSuccess:()=>{s.invalidateQueries({queryKey:["/reviews"]}),s.invalidateQueries({queryKey:[`/users/${T?.id}/lectures`]}),s.invalidateQueries({queryKey:["/users/written-reviews"]}),s.invalidateQueries({queryKey:["/users/writable-review"]})}}),{query:v}=R("GET","/users/written-reviews",{enabled:N==="success"});o.useEffect(()=>{if(v.data){const a=v.data.reviews.find(p=>p.lectureId===t);q(a||null)}},[v.data,t]);const[w,y]=o.useState(""),[d,g]=o.useState(0),[c,h]=o.useState(0),[u,b]=o.useState(0);function E(){y(""),g(0),h(0),b(0)}o.useEffect(()=>{E()},[t]),o.useEffect(()=>{r?(y(r.content),g(r.grade),h(r.load),b(r.speech)):E()},[r]);function $(){r?(G({content:w,grade:d,load:c,speech:u}),k("Edit Review",{reviewId:r.id,lectureId:t,courseName:e,grade:d,load:c,speech:u})):(K({lectureId:t,content:w,grade:d,load:c,speech:u}),k("Submit Review",{lectureId:t,courseName:e,grade:d,load:c,speech:u}))}return f(U,{direction:"column",gap:8,align:"stretch",children:[f(l,{direction:"row",gap:6,align:"center",children:[i(m,{type:"NormalBold",color:"Text.default",children:e}),[D(S),Q,P(B||_.SPRING)].map((a,p)=>i(m,{type:"Normal",color:"Text.lighter",children:a},p))]}),i(M,{direction:"column",gap:0,justify:"stretch",align:"stretch",children:i(C,{placeholder:n("common.review.writingPlaceholder"),value:w,handleChange:y,area:!0})}),f(l,{direction:"row",gap:20,justify:"space-between",align:"center",children:[i(O,{direction:"row",gap:12,children:[[n("common.grade"),d,g],[n("common.load"),c,h],[n("common.speech"),u,b]].map(([a,p,F])=>f(l,{direction:"row",gap:6,align:"center",children:[i(m,{type:"Normal",color:"Text.default",children:a}),i(I,{score:p,setScore:F})]},a))}),i(j,{type:w&&d&&u&&c?"selected":"disabled",$paddingLeft:8,$paddingTop:8,onClick:$,children:i(m,{type:"Normal",children:n(r?"writeReviews.write.edit":"common.upload")})})]})]})}export{se as R};
//# sourceMappingURL=ReviewWritingBlock-D0v1TQ6P.js.map
